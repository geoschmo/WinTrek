<Window x:Class="WinTrek.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:WinTrek.UI.ViewModels"
        xmlns:conv="clr-namespace:WinTrek.UI.Converters"
        mc:Ignorable="d"
        Title="WinTrek - USS Enterprise NCC-1701" Height="720" Width="1050"
        Background="{DynamicResource LcarsBackgroundBrush}">

    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>

    <Window.Resources>
        <!-- Converters -->
        <conv:SectorContentToColorConverter x:Key="SectorContentToColorConverter"/>
        <conv:ConditionToColorConverter x:Key="ConditionToColorConverter"/>
        <conv:MessageTypeToColorConverter x:Key="MessageTypeToColorConverter"/>
    </Window.Resources>

    <Grid Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- LCARS Header Bar -->
        <Border Grid.Row="0" Background="{DynamicResource LcarsOrangeBrush}"
                CornerRadius="20,20,0,0" Margin="0,0,0,5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Left elbow -->
                <Border Grid.Column="0" Background="{DynamicResource LcarsPurpleBrush}"
                        Width="100" CornerRadius="20,0,0,0" Margin="0,0,5,0">
                    <TextBlock Text="LCARS" FontFamily="Arial Black" FontSize="14"
                               Foreground="Black" HorizontalAlignment="Center"
                               VerticalAlignment="Center"/>
                </Border>

                <!-- Title -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" Margin="10,5">
                    <TextBlock Text="USS ENTERPRISE" FontFamily="Arial Black" FontSize="16"
                               Foreground="Black" Margin="0,0,20,0"/>
                    <Menu Background="Transparent">
                        <MenuItem Header="_GAME" FontFamily="Arial Black" FontSize="11" Foreground="Black">
                            <MenuItem Header="_New Game" Command="{Binding NewGameCommand}"/>
                            <Separator/>
                            <MenuItem Header="_Save Game" Command="{Binding SaveGameCommand}"/>
                            <MenuItem Header="_Load Game" Command="{Binding LoadGameCommand}"/>
                            <Separator/>
                            <MenuItem Header="E_xit" Click="ExitMenuItem_Click"/>
                        </MenuItem>
                    </Menu>
                </StackPanel>

                <!-- Right accent -->
                <Border Grid.Column="2" Background="{DynamicResource LcarsBeigeBrush}"
                        Width="80" CornerRadius="0,20,0,0"/>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="280"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel: Status & Controls -->
            <StackPanel Grid.Column="0">

                <!-- Ship Status -->
                <GroupBox Header="SHIP STATUS" Style="{DynamicResource LcarsGroupBox}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Label Grid.Row="0" Content="REGION:" Style="{DynamicResource LcarsLabel}"/>
                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding QuadrantName}"
                                   Style="{DynamicResource LcarsTextBlock}" VerticalAlignment="Center"/>

                        <Label Grid.Row="1" Content="QUADRANT:" Style="{DynamicResource LcarsLabel}"/>
                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding QuadrantPosition}"
                                   Style="{DynamicResource LcarsTextBlock}" VerticalAlignment="Center"/>

                        <Label Grid.Row="2" Content="SECTOR:" Style="{DynamicResource LcarsLabel}"/>
                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding SectorPosition}"
                                   Style="{DynamicResource LcarsTextBlock}" VerticalAlignment="Center"/>

                        <Label Grid.Row="3" Content="STARDATE:" Style="{DynamicResource LcarsLabel}"/>
                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding Stardate}"
                                   Style="{DynamicResource LcarsTextBlock}" VerticalAlignment="Center"/>

                        <Label Grid.Row="4" Content="TIME LEFT:" Style="{DynamicResource LcarsLabel}"/>
                        <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding TimeRemaining}"
                                   Style="{DynamicResource LcarsTextBlock}" VerticalAlignment="Center"/>

                        <Label Grid.Row="5" Content="CONDITION:" Style="{DynamicResource LcarsLabel}"/>
                        <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding Condition}"
                                   VerticalAlignment="Center" FontWeight="Bold" FontFamily="Arial Black"
                                   Foreground="{Binding Condition, Converter={StaticResource ConditionToColorConverter}}"/>

                        <Label Grid.Row="6" Content="ENERGY:" Style="{DynamicResource LcarsLabel}"/>
                        <TextBlock Grid.Row="6" Grid.Column="1" Text="{Binding Energy}"
                                   Style="{DynamicResource LcarsTextBlock}" VerticalAlignment="Center"/>

                        <Label Grid.Row="7" Content="SHIELDS:" Style="{DynamicResource LcarsLabel}"/>
                        <TextBlock Grid.Row="7" Grid.Column="1" Text="{Binding ShieldLevel}"
                                   Style="{DynamicResource LcarsTextBlock}" VerticalAlignment="Center"/>

                        <Label Grid.Row="8" Content="TORPEDOES:" Style="{DynamicResource LcarsLabel}"/>
                        <TextBlock Grid.Row="8" Grid.Column="1" Text="{Binding PhotonTorpedoes}"
                                   Style="{DynamicResource LcarsTextBlock}" VerticalAlignment="Center"/>

                        <Label Grid.Row="9" Content="DOCKED:" Style="{DynamicResource LcarsLabel}"/>
                        <TextBlock Grid.Row="9" Grid.Column="1" Text="{Binding IsDocked}"
                                   Style="{DynamicResource LcarsTextBlock}" VerticalAlignment="Center"/>
                    </Grid>
                </GroupBox>

                <!-- Mission Status -->
                <GroupBox Header="MISSION STATUS" Style="{DynamicResource LcarsGroupBox}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="KLINGONS:" Style="{DynamicResource LcarsLabel}" Width="90"/>
                            <TextBlock Text="{Binding TotalKlingons}" VerticalAlignment="Center" Margin="10,0,0,0"
                                       Foreground="{DynamicResource LcarsRedBrush}" FontWeight="Bold" FontFamily="Consolas" FontSize="18"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <Label Content="STARBASES:" Style="{DynamicResource LcarsLabel}" Width="90"/>
                            <TextBlock Text="{Binding TotalStarbases}" VerticalAlignment="Center" Margin="10,0,0,0"
                                       Foreground="{DynamicResource LcarsGreenBrush}" FontWeight="Bold" FontFamily="Consolas" FontSize="18"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Navigation -->
                <GroupBox Header="NAVIGATION" Style="{DynamicResource LcarsGroupBox}">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <Label Content="DIRECTION:" Style="{DynamicResource LcarsLabel}" Width="85"/>
                                <TextBox Text="{Binding NavigationDirection}" Width="50"
                                         Style="{DynamicResource LcarsTextBox}"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,2">
                                <Label Content="WARP:" Style="{DynamicResource LcarsLabel}" Width="85"/>
                                <TextBox Text="{Binding NavigationWarpFactor}" Width="50"
                                         Style="{DynamicResource LcarsTextBox}"/>
                            </StackPanel>
                            <Button Content="ENGAGE" Command="{Binding NavigateCommand}"
                                    Style="{DynamicResource AnimatedLcarsButton}" Margin="0,5,0,0"/>
                        </StackPanel>

                        <!-- Direction Compass -->
                        <Grid Grid.Column="1" Margin="10,0,5,0" VerticalAlignment="Center">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="28"/>
                                <ColumnDefinition Width="28"/>
                                <ColumnDefinition Width="28"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="4" FontFamily="Consolas" FontSize="16"
                                       Foreground="{DynamicResource LcarsBeigeBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Grid.Row="0" Grid.Column="1" Text="3" FontFamily="Consolas" FontSize="16"
                                       Foreground="{DynamicResource LcarsBeigeBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Grid.Row="0" Grid.Column="2" Text="2" FontFamily="Consolas" FontSize="16"
                                       Foreground="{DynamicResource LcarsBeigeBrush}" HorizontalAlignment="Center"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="5" FontFamily="Consolas" FontSize="16"
                                       Foreground="{DynamicResource LcarsBeigeBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Grid.Row="1" Grid.Column="1" Text="*" FontFamily="Consolas" FontSize="16"
                                       Foreground="{DynamicResource LcarsOrangeBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Grid.Row="1" Grid.Column="2" Text="1" FontFamily="Consolas" FontSize="16"
                                       Foreground="{DynamicResource LcarsBeigeBrush}" HorizontalAlignment="Center"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="6" FontFamily="Consolas" FontSize="16"
                                       Foreground="{DynamicResource LcarsBeigeBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" Text="7" FontFamily="Consolas" FontSize="16"
                                       Foreground="{DynamicResource LcarsBeigeBrush}" HorizontalAlignment="Center"/>
                            <TextBlock Grid.Row="2" Grid.Column="2" Text="8" FontFamily="Consolas" FontSize="16"
                                       Foreground="{DynamicResource LcarsBeigeBrush}" HorizontalAlignment="Center"/>
                        </Grid>
                    </Grid>
                </GroupBox>

                <!-- Shields -->
                <GroupBox Header="SHIELD CONTROL" Style="{DynamicResource LcarsGroupBox}">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <Label Content="ENERGY:" Style="{DynamicResource LcarsLabel}" Width="70"/>
                            <TextBox Text="{Binding ShieldTransfer}" Width="50"
                                     Style="{DynamicResource LcarsTextBox}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,5,0,0">
                            <Button Content="ADD" Command="{Binding AddShieldsCommand}"
                                    Style="{DynamicResource LcarsButton}" Width="100"/>
                            <Button Content="REMOVE" Command="{Binding RemoveShieldsCommand}"
                                    Style="{DynamicResource LcarsButtonSecondary}" Width="100"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>
            </StackPanel>

            <!-- Center Panel: Sector Grid & Messages -->
            <Grid Grid.Column="1" Margin="5,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="180"/>
                </Grid.RowDefinitions>

                <!-- Sector Display -->
                <GroupBox Header="SHORT RANGE SCAN" Grid.Row="0" Style="{DynamicResource LcarsGroupBox}">
                    <Border Background="#0a0a15" CornerRadius="5" Padding="5">
                        <ItemsControl ItemsSource="{Binding SectorGrid}">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <UniformGrid Rows="8" Columns="8"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border BorderBrush="{DynamicResource LcarsPurpleBrush}"
                                            BorderThickness="1" Background="#050510" Margin="1">
                                        <TextBlock Text="{Binding Symbol}"
                                                   FontFamily="Consolas"
                                                   FontSize="14"
                                                   FontWeight="Bold"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Foreground="{Binding Content, Converter={StaticResource SectorContentToColorConverter}}"/>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </Border>
                </GroupBox>

                <!-- Communications -->
                <GroupBox Header="COMMUNICATIONS" Grid.Row="1" Style="{DynamicResource LcarsGroupBox}">
                    <ListBox ItemsSource="{Binding Messages}"
                             Background="#0a0a15"
                             BorderThickness="0"
                             Style="{DynamicResource LcarsListBox}">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Message}"
                                           Foreground="{Binding Type, Converter={StaticResource MessageTypeToColorConverter}}"
                                           FontFamily="Consolas"
                                           FontSize="11"
                                           TextWrapping="Wrap"/>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </GroupBox>
            </Grid>

            <!-- Right Panel: Weapons & Computer -->
            <StackPanel Grid.Column="2">

                <!-- Weapons -->
                <GroupBox Header="TACTICAL" Style="{DynamicResource LcarsGroupBox}">
                    <StackPanel>
                        <TextBlock Text="PHASERS" FontWeight="Bold" Margin="0,5"
                                   Foreground="{DynamicResource LcarsBeigeBrush}" FontFamily="Arial Black"/>
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <Label Content="ENERGY:" Style="{DynamicResource LcarsLabel}" Width="70"/>
                            <TextBox Text="{Binding PhaserEnergy}" Width="50"
                                     Style="{DynamicResource LcarsTextBox}"/>
                        </StackPanel>
                        <Button Content="FIRE PHASERS" Command="{Binding FirePhasersCommand}"
                                Style="{DynamicResource AnimatedAlertButton}"/>

                        <TextBlock Text="TORPEDOES" FontWeight="Bold" Margin="0,10,0,5"
                                   Foreground="{DynamicResource LcarsBeigeBrush}" FontFamily="Arial Black"/>
                        <StackPanel Orientation="Horizontal" Margin="0,2">
                            <Label Content="DIRECTION:" Style="{DynamicResource LcarsLabel}" Width="80"/>
                            <TextBox Text="{Binding TorpedoDirection}" Width="50"
                                     Style="{DynamicResource LcarsTextBox}"/>
                        </StackPanel>
                        <Button Content="FIRE TORPEDO" Command="{Binding FireTorpedoCommand}"
                                Style="{DynamicResource AnimatedAlertButton}"/>
                    </StackPanel>
                </GroupBox>

                <!-- Sensors -->
                <GroupBox Header="SENSORS" Style="{DynamicResource LcarsGroupBox}">
                    <StackPanel>
                        <Button Content="SHORT RANGE SCAN" Command="{Binding ShortRangeScanCommand}"
                                Style="{DynamicResource LcarsButton}"/>
                        <Button Content="LONG RANGE SCAN" Command="{Binding LongRangeScanCommand}"
                                Style="{DynamicResource LcarsButton}"/>
                    </StackPanel>
                </GroupBox>

                <!-- Computer -->
                <GroupBox Header="COMPUTER" Style="{DynamicResource LcarsGroupBox}">
                    <StackPanel>
                        <Button Content="GALACTIC RECORD" Command="{Binding ViewGalacticRecordCommand}"
                                Style="{DynamicResource LcarsButtonSecondary}"/>
                        <Button Content="STATUS REPORT" Command="{Binding ViewStatusReportCommand}"
                                Style="{DynamicResource LcarsButtonSecondary}"/>
                        <Button Content="TORPEDO CALC" Command="{Binding CalculateTorpedoSolutionsCommand}"
                                Style="{DynamicResource LcarsButtonSecondary}"/>
                    </StackPanel>
                </GroupBox>

            </StackPanel>
        </Grid>
    </Grid>
</Window>
